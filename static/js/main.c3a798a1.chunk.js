(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,n){e.exports=n(76)},76:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(18),c=n.n(i),o=n(10),l=n.n(o),u=n(12),s=n(9),d=n(8),m=n(2),p=n(1),f=n(30),g=n.n(f),h=function(e){var t=e.alt,n=Object(a.useMemo)(function(){return function(){var e=.5+7*Math.random();return"../img/errorPics/"+(e=Math.round(e))+".png"}()},[t]);return r.a.createElement("img",{class:"Error",style:{display:"block",width:"50%",maxWidth:"240px",margin:"20px auto"},src:n,alt:t})},b=n(19),E=n.n(b),v=n(31),O=n(11),x=n.n(O),y=function(e,t){return x.a.get("https://translate.yandex.net/api/v1.5/tr.json/translate",{params:{key:"trnsl.1.1.20190622T182315Z.1c08f1b4d5342375.b70f9b65f37cf1d5176f32804b70c4d4fb35cd7c",text:e,lang:t}})},j=function(){var e=Object(v.a)(E.a.mark(function e(t,n){var a,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.meta){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,y(t.meta.title,n);case 4:return a=e.sent.data.text[0],e.next=7,y(t.meta.description,n);case 7:return r=e.sent.data.text[0],e.abrupt("return",{title:a,description:r});case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),C=function(e,t){var n=Object(a.useState)(),r=Object(m.a)(n,2),i=r[0],c=r[1];return Object(a.useEffect)(function(){y(e,t).then(function(e){return c(e.data.text[0])})},[e,t]),i},k=function(e){var t=e.language,n=C("404 \u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430",t),a=C("\u0414\u0430\u043d\u043d\u044b\u0439 \u043e\u043f\u0440\u043e\u0441 \u0443\u0436\u0435 \u0437\u0430\u043a\u0440\u044b\u0442 \u0438\u043b\u0438 \u0435\u0449\u0451 \u043d\u0435 \u0441\u043e\u0437\u0434\u0430\u043d",t);return r.a.createElement(p.View,null,r.a.createElement(p.Panel,null,r.a.createElement(p.Div,{style:{paddingTop:30,paddingBottom:60,color:"gray",textAlign:"center"}},r.a.createElement("h2",null,n),r.a.createElement(h,{alt:"whoops"}),r.a.createElement("p",null,a))))},A=n(32),w=function(e,t){var n=e.title,r=e.description,i=e.options,c=Object(a.useState)({}),o=Object(m.a)(c,2),l=o[0],u=o[1],s=Object(a.useState)(!1),p=Object(m.a)(s,2),f=p[0],g=p[1];return Object(a.useEffect)(function(){g(!0);var e=n&&y(n,t),a=r&&y(r,t),c=i&&i.map(function(e){return y(e,t)})||[];Promise.all([e,a].concat(Object(d.a)(c))).then(function(e){var t=Object(A.a)(e),n=t[0],a=t[1],r=t.slice(2);u({title:n&&n.data.text[0],description:a&&a.data.text[0],options:r&&r.map(function(e){return e.data.text[0]})}),g(!1)})},[n,r,i]),{translated:l,isLoading:f}},S=function(e){var t=e.id,n=e.title,a=e.description,i=e.options,c=e.value,o=e.onChange,l=e.hasAnotherOption,u=e.language,s=w({title:n,description:a,options:i},u),d=s.translated;return s.isLoading?r.a.createElement(p.Spinner,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.Cell,{description:d.description||a,multiline:!0},d.title||n),i.map(function(e,n){return r.a.createElement(p.Radio,{name:t,checked:c.selectedAnswer===e,onChange:function(t){o({selectedAnotherOption:!1,selectedAnswer:e})}},d.options&&d.options[n]||e)}),l&&r.a.createElement(p.Radio,{style:{color:"black!important"},name:t,description:"\u0414\u0440\u0443\u0433\u043e\u0435",checked:"\u0414\u0440\u0443\u0433\u043e\u0435"===c.selectedAnswer,onChange:function(e){o({selectedAnotherOption:!0,selectedAnswer:"\u0414\u0440\u0443\u0433\u043e\u0435"})}}))};S.defaultProps={value:{selectedAnotherOption:!1,selectedAnswer:""},hasAnotherOption:!1};var P=S,B=function(e){var t=e.id,n=e.title,a=e.description,i=e.placeholder,c=e.options,o=e.value,l=e.onChange,u=e.language,s=w({title:n,description:a,options:c},u),d=s.translated,m=s.isLoading;return o.selectedAnswer||l({selectedAnswer:c[0]}),m?r.a.createElement(p.Spinner,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.Cell,{description:d.description||a,multiline:!0},d.title||n),r.a.createElement(p.Select,{id:t,placeholder:i,onChange:function(e){l({selectedAnswer:e.target.value})},value:o.selectedAnswer},c.map(function(e,t){return r.a.createElement("option",{value:e},d.options&&d.options[t]||e)})))};B.defaultProps={value:{selectedAnswer:""}};var T=B,L=(n(29),function(e){var t=e.id,n=e.title,i=e.placeholder,c=e.description,o=e.onChange,l=e.value,u=e.language,s=e.expanded,d=w({title:n,description:c},u),m=d.translated,f=d.isLoading;return Object(a.useEffect)(function(){var e=setTimeout(function(){y(l.text,"ru").then(function(e){return o({text:l.text,translatedValue:e.data.text[0]})})},1e3);return function(){clearTimeout(e)}},[l.text]),f?r.a.createElement(p.Spinner,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.Cell,{description:m.description||c,multiline:!0},m.title||n),s?r.a.createElement(p.Textarea,{type:"text",name:t,defaultValue:i,onChange:function(e){o({text:e.target.value})},value:l.text}):r.a.createElement(p.Input,{type:"text",name:t,defaultValue:i,onChange:function(e){o({text:e.target.value})},value:l.text}))});L.defaultProps={value:{text:""},expanded:!1};var D=L,I=function(e){e.id;var t=e.title,n=e.description,i=e.options,c=e.value,o=e.onChange,l=e.hasAnotherOption,u=e.language,s=Object(a.useState)(c.selectedAnswers),f=Object(m.a)(s,2),g=f[0],h=f[1],b=g.some(function(e){return"\u0414\u0440\u0443\u0433\u043e\u0435"===e}),E=w({title:t,description:n,options:i},u),v=E.translated,O=E.isLoading;return Object(a.useEffect)(function(){o({selectedAnotherOption:b,selectedAnswers:g})},[g]),O?r.a.createElement(p.Spinner,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(p.Cell,{description:v.description||n,multiline:!0},v.title||t),i.map(function(e,t){return r.a.createElement(p.Checkbox,{value:e,defaultChecked:-1!==g.indexOf(e),onChange:function(e){e.target.checked?h([].concat(Object(d.a)(g),[e.target.value])):h(g.filter(function(t){return t!==e.target.value}))}},v.options&&v.options[t]||e)}),l&&r.a.createElement(p.Checkbox,{value:"\u0414\u0440\u0443\u0433\u043e\u0435",defaultChecked:-1!==g.indexOf("\u0414\u0440\u0443\u0433\u043e\u0435"),onChange:function(e){h(b?g.filter(function(e){return"\u0414\u0440\u0443\u0433\u043e\u0435"!==e}):[].concat(Object(d.a)(g),["\u0414\u0440\u0443\u0433\u043e\u0435"]))}},"\u0414\u0440\u0443\u0433\u043e\u0435"))};I.defaultProps={value:{selectedAnotherOption:!1,selectedAnswers:[]},hasAnotherOption:!1};var M=I,N=function(e){var t=e.question,n=e.value,a=e.onChange,i=(e.status,e.language);return"TEXTAREA"===t.type||"TEXT"===t.type?r.a.createElement(p.FormLayout,null,r.a.createElement(D,{id:t.id,title:t.title,description:t.helpText,placeholder:t.placeholder,value:n,onChange:a,language:i,expanded:"TEXT"===t.type})):"MULTIPLE_CHOICE"===t.type?r.a.createElement(p.FormLayout,null,r.a.createElement(P,{id:t.id,title:t.title,description:t.helpText,placeholder:t.placeholder,options:t.options,hasAnotherOption:t.hasOtherOption,value:n,onChange:a,language:i})):"CHECKBOX"===t.type?r.a.createElement(p.FormLayout,null,r.a.createElement(M,{id:t.id,title:t.title,description:t.helpText,options:t.options,hasAnotherOption:t.hasOtherOption,value:n,onChange:a,language:i})):"DROPDOWN"===t.type?r.a.createElement(p.FormLayout,null,r.a.createElement(T,{id:t.id,title:t.title,description:t.helpText,options:t.options,value:n,onChange:a,language:i})):r.a.createElement("div",null,"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0442\u0438\u043f \u0432\u043e\u043f\u0440\u043e\u0441\u0430")},W=function(e){var t=e.confirmationMessage,n=e.language,i=C("\u041e\u043f\u0440\u043e\u0441 \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d",n),c=C(t,n),o=Object(a.useMemo)(function(){return"../img/sticker/".concat(Math.floor(10*Math.random())+1,".png")},[t]);return r.a.createElement(p.Div,{style:{paddingTop:30,paddingBottom:40,color:"gray",textAlign:"center"}},r.a.createElement("h2",null,i),r.a.createElement("img",{className:"Sticker",src:o,style:{display:"block",width:"50%",maxWidth:"240px",margin:"20px auto"},alt:"Thank You"}),r.a.createElement("p",null,c||t))},F=function(e){var t=e.title,n=e.company,a=e.description,i=e.onClick,c=e.language,o=C(t,c),l=C(a,c),u=C("\u041d\u0430\u0447\u0430\u0442\u044c",c);return r.a.createElement(p.Div,{className:"WelcomePage",style:{position:"fixed",top:0,right:0,left:0,bottom:0,paddingTop:"20vh",paddingRight:30,paddingLeft:30,textAlign:"center",color:"white"}},r.a.createElement(p.Div,{style:{fontSize:"1.5em",marginBottom:20}},o||t,n&&r.a.createElement(p.Div,{style:{fontSize:"0.4em"}},"by ",n)),r.a.createElement(p.Div,{style:{fontSize:"0.8em",maxHeight:"25vh",marginBottom:20,overflow:"auto"}},l||a),r.a.createElement(p.Div,null,r.a.createElement(p.Button,{size:"l",style:{background:"none",border:"2px solid white",color:"white"},stretched:!0,onClick:i},u)))},z=n(33),V=n.n(z),R=function(e){var t=e.language,n=e.setAnotherLanguage;return r.a.createElement(p.Group,null,r.a.createElement(p.List,null,[["ru","\u0420\u0443\u0441\u0441\u043a\u0438\u0439"],["en","English"],["be","\u0411\u0435\u043b\u0430\u0440\u0443\u0441\u043a\u0456"],["bg","\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"],["cs","\u010cesky"],["da","Deens"],["de","Deutsch"],["el","\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac"],["es","espa\xf1ol"],["fr","francais"],["zh","\u4e2d\u56fd"]].map(function(e){return r.a.createElement(p.Cell,{onClick:function(){return n(e[0])},asideContent:t===e[0]?r.a.createElement(V.a,{fill:"var(--accent)"}):null},e[1])})))},H=function(e){var t=e.onClick,n=e.disabled,a=e.text;return r.a.createElement(p.Button,{size:"l",stretched:!0,onClick:t,disabled:n},a)};H.defaultProps={disabled:!1,text:"\u0414\u0430\u043b\u0435\u0435"};var U=H,K=function(e){var t=e.onClick,n=(e.disabled,e.text);return r.a.createElement(p.Button,{size:"l",stretched:!0,onClick:t,style:{background:"#4bb34b",color:"white"}},n)};K.defaultProps={disabled:!1,text:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c"};var q=K,X=function(e){var t=e.onClick,n=e.text;return r.a.createElement(p.Button,{size:"l",stretched:!0,style:{marginRight:40},onClick:t},n)};X.defaultProps={text:"\u041d\u0430\u0437\u0430\u0434"};var Q=X,Y=function(e){var t=e.onBack,n=e.onNext,a=e.onSubmit,i=e.isNextButtonDisabled,c=e.isLastQuestion,o=e.isFirstQuestion,l=e.translation;return r.a.createElement(p.Div,{style:{display:"flex"}},!o&&r.a.createElement(Q,{onClick:t,text:l.backButton}),c?r.a.createElement(q,{onClick:a,text:l.submitButton}):r.a.createElement(U,{onClick:n,disabled:i,text:l.nextButton}))};Y.defaultProps={isNextButtonDisabled:!1};var _=Y,G=function(e){var t=Object(a.useRef)();return Object(a.useEffect)(function(){t.current=e}),t.current},J=function(e,t,n,a){return x.a.put("https://foodtechmoneymaker.herokuapp.com/surveys/".concat(e,"/responses/").concat(t),Object(s.a)({},n,{vkUser:a}),{mode:"no-cors"})},Z=function(e,t){return{surveyId:e,checkId:"",answeredQuestionsNumber:Object.entries(t).length,replies:Object.entries(t).reduce(function(e,t){var n=Object(m.a)(t,2),a=n[0],r=n[1];return[].concat(Object(d.a)(e),[Object(s.a)({questionId:a},r)])},[])}},$=n(16),ee=n.n($),te=n(34),ne=n.n(te);ee.a.extend(ne.a);var ae=function(e){var t=e.city,n=e.country,a=e.first_name,r=e.last_name,i=e.id,c=e.sex,o=e.timezone,l=e.bdate,u=ee()(),s=ee()(l,"DD.MM.YYYY"),d=u.diff(s,"year");return{vkId:i,firstName:a,lastName:r,city:t&&t.title,country:n&&n.title,gender:c,timezone:o,bdate:l,age:d}},re=(n(75),l.a),ie=function(){var e=window.location.hash.slice(1),t=Object(a.useState)({}),n=Object(m.a)(t,2),i=n[0],c=n[1],o=Object(a.useState)("Welcome"),l=Object(m.a)(o,2),f=l[0],h=l[1],b=Object(a.useState)("Welcome"),E=Object(m.a)(b,2),v=E[0],O=E[1],y=Object(a.useState)({}),A=Object(m.a)(y,2),w=A[0],S=A[1],P=Object(a.useState)([]),B=Object(m.a)(P,2),T=B[0],L=B[1],D=Object(a.useState)(null),I=Object(m.a)(D,2),M=I[0],z=I[1],V=Object(a.useState)(navigator.language.slice(0,2)),H=Object(m.a)(V,2),U=H[0],K=H[1],q=Object(a.useState)(),X=Object(m.a)(q,2),Q=X[0],Y=X[1],$=Object(a.useState)(!0),ee=Object(m.a)($,2),te=ee[0],ne=ee[1],ie=G(w),ce=Object(a.useState)({}),oe=Object(m.a)(ce,2),le=oe[0],ue=oe[1],se=Object(a.useMemo)(function(){return ae(le)},[le]),de=Object(a.useMemo)(function(){return Z(i.id,w)},[i.id,w]);Object(a.useEffect)(function(){re.subscribe(function(e){"VKWebAppGetUserInfoResult"===e.detail.type&&ue(e.detail.data)})},[le]),Object(a.useEffect)(function(){var t;(t=e,x.a.get("https://foodtechmoneymaker.herokuapp.com/surveys/".concat(t),{mode:"no-cors"})).then(function(e){c(e.data),ne(!1),j(e.data,U).then(function(e){return Y(e)})})},[e,U]);var me=C("\u0414\u0430\u043b\u0435\u0435",U),pe=C("\u041d\u0430\u0437\u0430\u0434",U),fe=C("\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c",U),ge=function(t){var n,a,r;ie[t.id]!==w[t.id]&&(M?J(e,M,de,se):(n=e,a=de,r=se,x.a.post("https://foodtechmoneymaker.herokuapp.com/surveys/".concat(n,"/responses"),Object(s.a)({},a,{vkUser:r}),{mode:"no-cors"})).then(function(e){z(e.data.id)}))};if(te)return r.a.createElement(p.View,{activePanel:"spinner"},r.a.createElement(p.Panel,{id:"spinner"},r.a.createElement(p.Spinner,{size:"large",style:{marginTop:"50%"}})));if(!i||!e)return r.a.createElement(k,{language:U});var he=i.questions.length-1;return r.a.createElement("div",null,r.a.createElement(p.View,{activePanel:f},[r.a.createElement(p.Panel,{id:"Welcome",style:{padding:0}},r.a.createElement(F,{language:U,onClick:function(){re.send("VKWebAppGetUserInfo"),h(0)},title:Q&&Q.title,description:Q&&Q.description,company:i.meta.company.companyName}))].concat(Object(d.a)(i.questions.map(function(t,n){var a,i,c=t.required&&(a=t.type,i=w[t.id],"TEXTAREA"===a?function(e){if(!e||!e.text)return"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u0435"}(i):"MULTIPLE_CHOICE"===a||"DROPDOWN"===a?function(e){if(!e||!e.selectedAnswer)return"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u0438\u043d \u043e\u0442\u0432\u0435\u0442"}(i):"CHECKBOX"===a?function(e){if(!e||!e.selectedAnswers||0===e.selectedAnswers.length)return"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u043e \u043f\u043e\u043b\u0435"}(i):"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"),o=c&&-1!==T.indexOf(t.id);return r.a.createElement(p.Panel,{id:n},r.a.createElement(p.PanelHeader,{left:r.a.createElement(p.HeaderButton,{onClick:function(){O(f),h("languages")}},r.a.createElement(g.a,null))},Q&&Q.title),r.a.createElement(p.Progress,{value:f/he*100}),o&&r.a.createElement(p.FormLayout,null,r.a.createElement(p.FormStatus,{state:"error"},c)),r.a.createElement(N,{question:t,value:w[t.id],onChange:function(e){S(Object(s.a)({},w,Object(u.a)({},t.id,Object(s.a)({type:t.type},e))))},language:U}),r.a.createElement(_,{onBack:function(){!function(t){ie[t.id]!==w[t.id]&&M&&J(e,M,de,se)}(t),h(f-1)},onNext:function(){L([].concat(Object(d.a)(T),[t.id])),ge(t),h(f+1)},onSubmit:function(){ge(t),h("confirmation")},isNextButtonDisabled:!!c,isFirstQuestion:0===f,isLastQuestion:f===he,translation:{nextButton:me,backButton:pe,submitButton:fe}}))})),[r.a.createElement(p.Panel,{id:"confirmation"},r.a.createElement(W,{confirmationMessage:"\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0437\u0430 \u0443\u0434\u0435\u043b\u0451\u043d\u043d\u043e\u0435 \u043d\u0430\u043c \u0432\u0440\u0435\u043c\u044f!",language:U})),r.a.createElement(p.Panel,{id:"languages"},r.a.createElement(p.PanelHeader,null,"\u0412\u044b\u0431\u043e\u0440 \u0441\u0442\u0440\u0430\u043d\u044b"),r.a.createElement(R,{language:U,setAnotherLanguage:function(e){K(e),h(v)}}))])))},ce=function(){return r.a.createElement(ie,null)};l.a.subscribe(function(e){if("VKWebAppUpdateConfig"===e.detail.type){var t=document.createAttribute("scheme");t.value=e.detail.data.scheme?e.detail.data.scheme:"client_light",document.body.attributes.setNamedItem(t)}}),l.a.send("VKWebAppInit",{}),l.a.send("VKWebAppGetUserInfo"),c.a.render(r.a.createElement(ce,null),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.c3a798a1.chunk.js.map